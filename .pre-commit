#!/bin/sh

check_title_length() {
	ERROR=0
	FILES=$(find docs -type f -name "*.html" )
	for file in $FILES; do
		title=$(cat $file | perl -l -0777 -ne 'print $1 if /<img.*?>\s*(.*?)\s*/si');
		if [ "${#title}" -gt "$1" ]
		then
			echo "⚠️ Title \"${title}\" has more than $1 characters. (${file})"
			ERROR=1;
		fi

		cat $file | grep "<img"
	done
	exit $ERROR
};

check_title_length 65;
